# 依赖构建
当我们首次运行 Vite 的时候，Vite 会先执行依赖预构建。将第三方依赖进行打包，放置在项目下的 **`/node_modules/.vite/deps`** 里，并在开发环境下使用这些打包后的第三方依赖。

为什么需要预构建，vite在官方文档中是这样表述的：
* **CommonJS 和 UMD 兼容性**：在开发阶段中，Vite 的开发服务器将所有代码视为原生 ES 模块，因此，Vite 必须先将作为 CommonJS 或 UMD 发布的依赖项转换为 ESM 模式才会能被浏览器加载。
* **性能**：Vite 将有许多内部模块的 ESM 依赖关系转换为单个模块，减少大量的请求阻塞浏览器，比如lodash-es 有超过 600 个内置模块，如果不做处理大量的请求会导致页面的加载速度相当慢。通过预构建 lodash-es 成为一个模块，我们就只需要发送一个 HTTP 请求了。

> ⚠️ 依赖预构建仅适用于开发模式，并使用 esbuild 将依赖项转换为 ES 模块。在生产构建中，将使用 @rollup/plugin-commonjs

要对依赖进行预构建，首先要搞清这两个问题：
* 1、预构建的内容是什么？（哪些模块需要进行预构建）
* 2、如何找到需要预构建的模块？（怎么去实现预构建）

接下来我们分这两方面去实现vite的依赖预构建。

  ## 依赖构建的内容
  
